<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>News Summarization</title>
    <script>
        async function fetchNews() {
            const response = await fetch("http://127.0.0.1:5000/news");
            const newsArticles = await response.json();
            const newsContainer = document.getElementById("news");

            newsContainer.innerHTML = ""; // Clear existing articles

            newsArticles.forEach((article, index) => {
                let articleDiv = document.createElement("div");
                articleDiv.classList.add("article");

                let title = document.createElement("h3");
                title.textContent = article.title;

                let description = document.createElement("p");
                description.textContent = article.description || "No description available.";

                let summarizeButton = document.createElement("button");
                summarizeButton.textContent = "Summarize";
                summarizeButton.onclick = async function() {
                    await fetchSummary(article.content || article.description, index);
                };

                let summaryDiv = document.createElement("p");
                summaryDiv.classList.add("summary");
                summaryDiv.id = `summary-${index}`;

                articleDiv.appendChild(title);
                articleDiv.appendChild(description);
                articleDiv.appendChild(summarizeButton);
                articleDiv.appendChild(summaryDiv);

                newsContainer.appendChild(articleDiv);
            });
        }

        async function fetchSummary(content, index) {
            const response = await fetch("http://127.0.0.1:5000/summarize", {
                method: "POST",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify({ content: content })
            });

            const data = await response.json();
            document.getElementById(`summary-${index}`).textContent = data.summary || "Error summarizing article.";
        }

        window.onload = fetchNews;
    </script>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
        }
        .article {
            border: 1px solid #ccc;
            padding: 10px;
            margin-bottom: 10px;
        }
        .summary {
            color: blue;
            font-style: italic;
        }
    </style>
</head>
<body>
    <h1>News Summarization</h1>
    <div id="news">Loading news...</div>
</body>
</html>